wandb: Currently logged in as: dejang. Use `wandb login --relogin` to force relogin
wandb: WARNING Ignored wandb.init() arg project when running a sweep.
wandb: WARNING Ignored wandb.init() arg entity when running a sweep.
wandb: Tracking run with wandb version 0.12.21
wandb: Run data is saved locally in /private/home/dejang/tools/loop_tool_env/loop_tool_service/models/cost_model/cost/wandb/run-20220722_150355-4l7dxwp5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/dejang/loop_tool
wandb: üßπ View sweep at https://wandb.ai/dejang/loop_tool/sweeps/dftmsroa
wandb: üöÄ View run at https://wandb.ai/dejang/loop_tool/runs/4l7dxwp5
  0%|          | 0/5 [00:00<?, ?it/s] 20%|‚ñà‚ñà        | 1/5 [00:06<00:26,  6.61s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 2/5 [00:09<00:13,  4.44s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 3/5 [00:12<00:07,  3.76s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 4/5 [00:15<00:03,  3.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [00:18<00:00,  3.27s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [00:18<00:00,  3.68s/it]
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: \ 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: | 0.001 MB of 0.001 MB uploaded (0.000 MB deduped)wandb: / 0.001 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: - 0.001 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: \ 0.001 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: | 0.020 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: / 0.020 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: - 0.025 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: \ 0.025 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: | 0.025 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: / 0.025 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: - 0.025 MB of 0.025 MB uploaded (0.000 MB deduped)wandb: \ 0.025 MB of 0.025 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: 
wandb: Run history:
wandb:        batch loss ‚ñá‚ñÜ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÖ‚ñá‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñà‚ñÇ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÇ‚ñÖ‚ñÑ‚ñÜ‚ñÉ‚ñÑ‚ñÑ‚ñÇ‚ñÑ‚ñÉ‚ñá‚ñÇ‚ñÖ‚ñÉ‚ñÇ‚ñÉ‚ñÉ‚ñÅ‚ñÉ‚ñÉ
wandb: final_performance ‚ñÅ
wandb:         test_loss ‚ñà‚ñÜ‚ñÖ‚ñÉ‚ñÅ
wandb:        train_loss ‚ñà‚ñÜ‚ñÑ‚ñÉ‚ñÅ
wandb: 
wandb: Run summary:
wandb:        batch loss 221.94653
wandb: final_performance 0.49165
wandb:         test_loss 326.41696
wandb:        train_loss 378.76566
wandb: 
wandb: Synced glorious-sweep-1: https://wandb.ai/dejang/loop_tool/runs/4l7dxwp5
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 1 other file(s)
wandb: Find logs at: ./wandb/run-20220722_150355-4l7dxwp5/logs
submitit ERROR (2022-07-22 15:04:43,617) - Submitted job triggered an exception
ERROR:submitit:Submitted job triggered an exception
Traceback (most recent call last):
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/submitit/core/_submit.py", line 11, in <module>
    submitit_main()
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/submitit/core/submission.py", line 72, in submitit_main
    process_job(args.folder)
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/submitit/core/submission.py", line 65, in process_job
    raise error
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/submitit/core/submission.py", line 54, in process_job
    result = delayed.result()
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/submitit/core/utils.py", line 133, in result
    self._result = self.function(*self.args, **self.kwargs)
  File "cost_sweep_slurm.py", line 212, in train
    torch.save(model, os.path.join(wandb.run.dir, "model.h5"))
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/torch/serialization.py", line 379, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/private/home/dejang/.conda/envs/compiler_gym/lib/python3.8/site-packages/torch/serialization.py", line 589, in _save
    pickler.dump(obj)
AttributeError: Can't pickle local object 'TorchHistory.add_log_hooks_to_pytorch_module.<locals>.<lambda>'
srun: error: learnfair2145: task 0: Exited with exit code 1
srun: launch/slurm: _step_signal: Terminating StepId=61401068.0
